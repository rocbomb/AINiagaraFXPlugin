# AINiagaraFXPlugin 开发计划书

## 📋 项目概述

**项目名称**: AINiagaraFXPlugin  
**目标平台**: Unreal Engine 5.5  
**项目类型**: 纯编辑器工具（无运行时依赖）  
**技术架构**: 混合架构（C++ 核心 API + Python UI/AI）  
**项目愿景**: 通过 AI 技术实现自然语言驱动的 Niagara 粒子特效编辑器工具  
**当前完成度**: 约 30%（C++ API基础完成，UI和AI未实现）  
**开发周期估算**: 6-8 周（Python加速UI和AI开发）

---

## 🎯 核心功能目标

### 最终用户体验
用户应能够：
1. 在编辑器中选择 Niagara 系统
2. 用自然语言描述想要的效果调整（如："让火焰更大更红"、"减慢粒子速度"）
3. AI 自动解析意图并实时修改相应参数
4. 实时预览效果并支持迭代调整
5. 保存和复用调整预设

---

## 📊 当前状态分析

### ✅ 已完成模块 (35%)

#### 1. 基础架构 (70%)
- ✅ 插件模块系统
- ⚠️ Runtime/Editor 双模块架构（需调整为纯Editor）
- ✅ 依赖管理完整
- ❌ Python 集成未配置
- ❌ .uplugin 需要添加 PythonScriptPlugin 依赖

#### 2. Niagara 变量读取 (90%)
- ✅ 20+ 种数据类型的 Get 函数
- ✅ 命名空间支持（User/Engine/System/Emitter 等）
- ✅ 编辑器和运行时双模式支持
- ✅ 参数列表枚举功能

#### 3. Niagara 变量写入 (30%)
- ✅ 6 个基础 Set 函数
- ❌ 缺失 14+ 个常用类型的 Set 函数
- 🐛 Namespace 参数未被使用（Bug）

#### 4. Blueprint 集成 (70%)
- ✅ 场景组件获取
- ✅ 参数名称查询
- ✅ 编辑器工具函数
- ❌ 缺少批量操作支持

### ❌ 未实现模块 (65%)

#### 1. AI 集成 (0%)
- ❌ 无任何 AI 服务连接
- ❌ 无自然语言处理
- ❌ 无参数映射逻辑

#### 2. 用户界面 (0%)
- ❌ 无 Python UI 脚本
- ❌ 无编辑器工具菜单注册
- ❌ 无参数调整界面
- ❌ 无 AI 对话窗口

#### 3. 配置与预设 (0%)
- ❌ 无预设保存系统
- ❌ 无历史记录
- ❌ 无参数模板

---

## 🗓️ 分阶段开发计划

### 第一阶段：基础功能完善 (2-3 周)

#### Week 1: 补全核心 API
**优先级**: 🔴 最高

##### 任务 1.1: 完善变量写入功能
- [ ] 实现所有缺失的 Set 函数（14 个）
  - SetNiagaraVariableBool
  - SetNiagaraVariableInt
  - SetNiagaraVariableFloat
  - SetNiagaraVariableColor
  - SetNiagaraVariableVec2/Vec3/Vec4
  - SetNiagaraVariableQuat
  - SetNiagaraVariableActor
  - SetNiagaraVariableUObject
  - SetNiagaraVariableUMaterial
  - SetNiagaraVariableUTextureRenderTarget
  - SetNiagaraVariableParameterMap
- [ ] 修复所有 Set 函数的 Namespace Bug
- [ ] 添加参数验证和边界检查
- [ ] 单元测试覆盖

**交付物**: 完整的变量读写 API

##### 任务 1.2: 插件配置文件
- [ ] 创建 .uplugin 文件
- [ ] 配置插件元数据（版本、作者、描述）
- [ ] 定义模块加载规则
- [ ] 设置依赖关系

**交付物**: 可正常加载的插件配置

##### 任务 1.3: 批量操作支持
- [ ] 实现批量参数读取
- [ ] 实现批量参数写入
- [ ] 添加参数组管理
- [ ] 性能优化（减少重复调用）

**交付物**: 批量操作 API

#### Week 2: Python 集成配置
**优先级**: 🔴 最高

##### 任务 2.1: Python 环境配置
- [ ] 修改 .uplugin，添加 PythonScriptPlugin 依赖
- [ ] 调整模块加载类型（移除 Runtime 或改为 Editor-only）
- [ ] 创建 Content/Python 目录结构
- [ ] 配置 Python 路径和初始化脚本
- [ ] 测试 Python 调用 C++ API

**交付物**: 可用的 Python 开发环境

#### Week 3: Python UI 开发
**优先级**: 🔴 最高

##### 任务 2.2: 主编辑器工具窗口（Python）
- [ ] 创建 EditorUtilityWidget 或使用 unreal.EditorUtilityLibrary
- [ ] 实现 Niagara 组件选择器（调用 C++ GetAllNiagaraComponentsInScene）
- [ ] 参数列表显示（调用 C++ GetNiagaraVariableNames）
- [ ] 实时参数值监控
- [ ] 注册到编辑器菜单（Tools > AI Niagara FX）

**交付物**: 基础 Python 编辑器面板

##### 任务 2.3: 参数调整界面（Python）
- [ ] 使用 unreal.EditorUtilityWidget 创建 UI
  - 数值滑块（调用 C++ Set 函数）
  - 颜色选择器
  - 向量编辑器
- [ ] 参数分组和搜索
- [ ] 参数重置功能
- [ ] 撤销/重做支持（利用 UE 的 Transaction 系统）

**交付物**: 完整的 Python 参数编辑 UI

---

### 第二阶段：AI 集成基础 (3-4 周)

#### Week 4-5: AI 服务接入（Python）
**优先级**: 🟡 高

##### 任务 3.1: Python AI SDK 集成
**技术选型建议**:
```
方案 A: 云端 AI（推荐 - Python 原生支持）
  - OpenAI Python SDK (pip install openai)
  - Anthropic Claude SDK (pip install anthropic)
  - 优点：Python 库成熟、开发快速
  - 缺点：需要网络、有成本

方案 B: 本地 AI（可选）
  - llama-cpp-python
  - transformers (HuggingFace)
  - 优点：无需网络、无成本
  - 缺点：性能要求高、UE 中集成复杂

推荐：使用方案 A（Python OpenAI SDK），配置简单
```

**实现任务**:
- [ ] 在 UE Python 环境中安装 openai 库
- [ ] 创建 AI 服务 Python 类（ai/openai_client.py）
- [ ] 配置管理（从 UE ProjectSettings 读取 API Key）
- [ ] 错误处理和重试机制
- [ ] 异步请求管理（使用 Python asyncio 或线程）

**交付物**: Python AI 服务集成

##### 任务 3.2: 提示词工程（Python）
- [ ] 设计系统提示词模板（Python 字符串模板）
- [ ] Niagara 参数类型说明文档（JSON 配置文件）
- [ ] 参数效果描述库（如 "SpawnRate 控制生成速度"）
- [ ] 上下文构建逻辑（从 C++ API 获取当前参数）
- [ ] Few-shot 示例库（Python 字典）

**示例 Python 实现**:
```python
import openai
import json

class NiagaraAIAssistant:
    def __init__(self, api_key):
        self.client = openai.OpenAI(api_key=api_key)
    
    def build_prompt(self, niagara_component, user_input):
        # 调用 C++ API 获取参数列表
        params = unreal.ExposeNiagaraVariablesEditorBPLibrary.get_niagara_variable_names(niagara_component)
        
        system_prompt = f"""
        你是 Niagara 粒子系统专家。
        当前系统参数：{json.dumps(params, indent=2)}
        
        请将用户需求转换为 JSON 格式的参数调整。
        """
        return system_prompt + "\n\n用户需求：" + user_input
    
    def adjust_parameters(self, niagara_component, user_input):
        prompt = self.build_prompt(niagara_component, user_input)
        response = self.client.chat.completions.create(
            model="gpt-4",
            messages=[{"role": "user", "content": prompt}]
        )
        
        # 解析 AI 返回的 JSON
        adjustments = json.loads(response.choices[0].message.content)
        
        # 调用 C++ Set 函数应用参数
        for param_name, value in adjustments.items():
            # 调用对应的 C++ Set 函数
            self.apply_parameter(niagara_component, param_name, value)
```

**交付物**: Python 提示词系统

##### 任务 3.3: 自然语言解析器
- [ ] 用户输入预处理
- [ ] AI 响应解析（JSON/结构化输出）
- [ ] 参数名称映射（处理模糊匹配）
- [ ] 数值范围验证
- [ ] 冲突检测（多个参数影响同一效果）

**交付物**: NLP 解析模块

#### Week 6-7: 参数映射与执行
**优先级**: 🟡 高

##### 任务 4.1: 智能参数映射
- [ ] 创建参数知识库
  ```cpp
  struct FParameterMetadata
  {
      FString Name;                    // User.SpawnRate
      FString DisplayName;             // "生成速率"
      FString Description;             // "控制粒子生成速度"
      TArray<FString> Aliases;         // ["spawn", "birth rate", "生成"]
      FFloatRange ValidRange;          // 0-1000
      FString EffectCategory;          // "Performance", "Visual", etc.
  };
  ```
- [ ] 参数语义分析
- [ ] 相关参数推荐（如调整颜色时提示亮度参数）
- [ ] 参数依赖关系管理

**交付物**: 参数元数据系统

##### 任务 4.2: AI 指令执行引擎
- [ ] 指令队列管理
- [ ] 安全性检查（防止崩溃参数）
- [ ] 渐进式调整（平滑过渡）
- [ ] 执行结果反馈
- [ ] 失败回滚机制

**交付物**: 指令执行系统

##### 任务 4.3: 对话上下文管理
- [ ] 会话历史记录
- [ ] 多轮对话支持（"再亮一点"）
- [ ] 参数调整堆栈
- [ ] 上下文相关性判断

**交付物**: 对话管理系统

---

### 第三阶段：高级功能与优化 (2-3 周)

#### Week 8-9: 预设与模板系统
**优先级**: 🟢 中

##### 任务 5.1: 预设保存/加载
- [ ] 预设数据结构设计
- [ ] 序列化/反序列化
- [ ] 预设库管理界面
- [ ] 预设分类和标签
- [ ] 预设导入/导出

**交付物**: 预设管理系统

##### 任务 5.2: 模板系统
- [ ] 常见效果模板（火焰、烟雾、爆炸等）
- [ ] 模板参数范围定义
- [ ] 模板应用向导
- [ ] 自定义模板创建

**交付物**: 效果模板库

##### 任务 5.3: 智能推荐
- [ ] 基于历史调整的推荐
- [ ] 相似效果查找
- [ ] 参数优化建议
- [ ] 性能优化提示

**交付物**: 推荐系统

#### Week 10: 性能优化与稳定性
**优先级**: 🟡 高

##### 任务 6.1: 性能优化
- [ ] 参数更新批处理
- [ ] AI 请求缓存
- [ ] 异步处理优化
- [ ] 内存使用优化
- [ ] 减少编辑器卡顿

**交付物**: 性能优化报告

##### 任务 6.2: 错误处理增强
- [ ] 全面的异常捕获
- [ ] 用户友好的错误提示
- [ ] 详细的日志系统
- [ ] Crash 防护
- [ ] 自动错误报告

**交付物**: 稳定性增强

---

### 第四阶段：文档与发布 (1-2 周)

#### Week 11-12: 文档编写
**优先级**: 🟢 中

##### 任务 7.1: 用户文档
- [ ] 快速开始指南
- [ ] 功能完整说明
- [ ] 视频教程录制
- [ ] 常见问题解答
- [ ] 最佳实践指南

**交付物**: 完整用户文档

##### 任务 7.2: 开发者文档
- [ ] API 参考文档
- [ ] 架构设计文档
- [ ] 扩展开发指南
- [ ] 代码注释完善
- [ ] 示例项目

**交付物**: 开发者文档

##### 任务 7.3: 发布准备
- [ ] 版本号规划
- [ ] 更新日志编写
- [ ] 许可证文件
- [ ] 示例资产准备
- [ ] Marketplace 提交材料

**交付物**: 发布包

---

## 🏗️ 技术架构设计（混合架构）

### 模块划分

```
AINiagaraFXPlugin/
├── Source/
│   ├── AINiagaraFXPluginEditor/      # C++ 编辑器模块（核心 API）
│   │   ├── Public/
│   │   │   ├── NiagaraVariableHelpers.h       # 参数读写 API（已有）
│   │   │   ├── ExposeNiagaraVariablesEditorBPLibrary.h  # BP/Python 接口（已有）
│   │   │   └── BatchOperations.h              # 批量操作 API（新增）
│   │   └── Private/
│   │       ├── NiagaraVariableHelpers.cpp
│   │       └── BatchOperations.cpp
│   └── AINiagaraFXPlugin/            # 可选：保留最小化或合并到Editor
│
├── Content/
│   └── Python/                        # Python 脚本（UI 和 AI 逻辑）
│       ├── init_unreal.py                # 插件初始化，注册编辑器菜单
│       ├── ui/
│       │   ├── main_window.py                # 主编辑器窗口（EditorUtilityWidget）
│       │   ├── parameter_panel.py            # 参数调整面板
│       │   └── chat_interface.py             # AI 对话界面
│       ├── ai/
│       │   ├── openai_client.py              # OpenAI API 封装
│       │   ├── prompt_builder.py             # 提示词构建
│       │   └── response_parser.py            # AI 响应解析
│       ├── niagara/
│       │   ├── parameter_manager.py          # 参数管理（调用 C++ API）
│       │   ├── parameter_metadata.json       # 参数知识库
│       │   └── preset_system.py              # 预设管理
│       └── utils/
│           ├── config.py                     # 配置管理（API Key等）
│           └── logger.py                     # 日志工具
│
└── AINiagaraFXPlugin.uplugin      # 插件配置（添加 PythonScriptPlugin）
```

### 数据流设计（混合架构）

```
用户在 Python UI 中输入自然语言
    ↓
[chat_interface.py] 捕获输入
    ↓
[parameter_manager.py] 调用 C++ API 获取当前参数
    ↓ unreal.ExposeNiagaraVariablesEditorBPLibrary.get_niagara_variable_names()
    ↓
[prompt_builder.py] 构建提示词（包含参数上下文）
    ↓
[openai_client.py] 发送到 OpenAI API（Python SDK）
    ↓ openai.ChatCompletion.create()
    ↓
[response_parser.py] 解析 AI 返回的 JSON
    ↓
[parameter_manager.py] 验证参数名称和范围
    ↓
[parameter_manager.py] 调用 C++ Set 函数
    ↓ unreal.NiagaraVariableHelpers.set_niagara_variable_float()
    ↓
[C++ NiagaraVariableHelpers] 实际写入 Niagara 参数
    ↓
[UE Editor] 实时显示效果（自动更新）
    ↓
[UE Transaction System] 自动记录撤销/重做
```

### 混合架构优势

| 功能层 | 实现方式 | 优势 |
|---------|----------|------|
| **参数读写 API** | C++ | ✅ 高性能、稳定、原生 UE API |
| **批量操作** | C++ | ✅ 高效执行，减少跨语言调用 |
| **UI 界面** | Python | ✅ 快速迭代、即时修改、无需编译 |
| **AI 集成** | Python | ✅ OpenAI SDK 成熟、简单易用 |
| **提示词工程** | Python | ✅ 字符串处理方便、快速调整 |
| **配置管理** | Python + UE Settings | ✅ 灵活，可读取 ProjectSettings |
| **预设系统** | Python | ✅ JSON 处理简单 |

---

## 🔧 技术实现要点

### AI 服务集成方案

#### 方案 1: OpenAI GPT-4（推荐）
```cpp
// AIServiceOpenAI.h
class FAIServiceOpenAI : public IAIService
{
public:
    virtual TFuture<FString> SendPrompt(const FString& Prompt) override;
    
private:
    FString APIKey;
    FString EndpointURL = "https://api.openai.com/v1/chat/completions";
    TSharedPtr<IHttpRequest> CreateRequest(const FString& Prompt);
};
```

**优点**:
- 理解能力强
- 输出稳定
- 文档完善

**缺点**:
- 需要网络
- 有使用成本（~$0.03/1K tokens）
- 可能有延迟

#### 方案 2: 本地 LLM（未来扩展）
```cpp
// AIServiceLocal.h
class FAIServiceLocal : public IAIService
{
public:
    virtual TFuture<FString> SendPrompt(const FString& Prompt) override;
    
private:
    void* ModelHandle;  // Llama.cpp model
    FString ModelPath;
};
```

**优点**:
- 无需网络
- 无使用成本
- 数据隐私

**缺点**:
- 性能要求高
- 效果可能较差
- 模型集成复杂

### 参数知识库设计

```json
{
  "parameters": [
    {
      "name": "User.SpawnRate",
      "type": "Float",
      "displayName": "生成速率",
      "description": "控制每秒生成的粒子数量",
      "aliases": ["spawn", "birth rate", "emission", "生成", "发射"],
      "range": { "min": 0, "max": 1000 },
      "defaultValue": 100,
      "category": "Performance",
      "affectsPerformance": true,
      "relatedParameters": ["User.Lifetime", "User.MaxParticles"],
      "examples": [
        { "intent": "增加粒子数量", "value": 500 },
        { "intent": "减少粒子", "value": 50 }
      ]
    },
    {
      "name": "User.Color",
      "type": "LinearColor",
      "displayName": "粒子颜色",
      "description": "粒子的基础颜色",
      "aliases": ["color", "颜色", "tint", "色调"],
      "category": "Visual",
      "relatedParameters": ["User.EmissiveStrength", "User.Opacity"],
      "presets": {
        "火焰": {"r": 1.0, "g": 0.3, "b": 0.1, "a": 1.0},
        "冰霜": {"r": 0.5, "g": 0.8, "b": 1.0, "a": 1.0},
        "毒素": {"r": 0.2, "g": 1.0, "b": 0.3, "a": 1.0}
      }
    }
  ]
}
```

### 提示词模板示例

```cpp
FString BuildPrompt(const UNiagaraComponent* Component, const FString& UserInput)
{
    FString SystemPrompt = TEXT(R"(
你是 Unreal Engine Niagara 粒子系统专家。
你的任务是将用户的自然语言描述转换为精确的参数调整指令。

当前 Niagara 系统参数：
{PARAMETER_LIST}

规则：
1. 只输出 JSON 格式，不要额外解释
2. 参数名称必须完全匹配
3. 数值必须在有效范围内
4. 如果不确定，只调整最相关的参数

输出格式：
{
  "parameters": [
    {"name": "User.ParamName", "value": 100}
  ],
  "explanation": "调整说明"
}
)");

    // 构建参数列表
    FString ParamList = GetParameterListString(Component);
    SystemPrompt.ReplaceInline(TEXT("{PARAMETER_LIST}"), *ParamList);
    
    // 构建完整提示词
    return FString::Printf(TEXT("%s\n\n用户需求：%s"), *SystemPrompt, *UserInput);
}
```

---

## 📐 UI 设计草图

### 主编辑器面板布局

```
┌─────────────────────────────────────────────────────────┐
│  AI Niagara FX Plugin                          [×] [−] [□] │
├─────────────────────────────────────────────────────────┤
│ ┌─────────────────┐ ┌─────────────────────────────────┐ │
│ │ Niagara 组件    │ │ AI 对话界面                      │ │
│ │                 │ │                                  │ │
│ │ ☑ NS_Fire_01   │ │ > 让火焰更大更红                 │ │
│ │ ☐ NS_Smoke_02  │ │ ✓ 已调整：                       │ │
│ │ ☐ NS_Magic_03  │ │   - Color: (1.0, 0.2, 0.1)      │ │
│ │                 │ │   - Size: 2x                    │ │
│ │ [刷新列表]      │ │                                  │ │
│ │                 │ │ > 减慢粒子速度                   │ │
│ └─────────────────┘ │ ✓ 已调整：                       │ │
│                     │   - Velocity: 0.5x              │ │
│ ┌─────────────────┐ │                                  │ │
│ │ 参数列表        │ │ [输入调整需求...]    [发送]     │ │
│ │                 │ └─────────────────────────────────┘ │
│ │ User 参数       │                                      │
│ │ ├─ SpawnRate   │ ┌─────────────────────────────────┐ │
│ │ │  100 ◄━━━━►  │ │ 实时预览                         │ │
│ │ ├─ Color       │ │                                  │ │
│ │ │  [■] 选择    │ │    [Niagara 效果实时渲染区域]    │ │
│ │ ├─ Size        │ │                                  │ │
│ │ │  (1,1,1)     │ │                                  │ │
│ │                 │ │                                  │ │
│ │ [重置全部]      │ │ [对比模式] [保存预设] [撤销]    │ │
│ └─────────────────┘ └─────────────────────────────────┘ │
└─────────────────────────────────────────────────────────┘
```

---

## 📊 里程碑与验收标准

### Milestone 1: 基础 API 完善 (Week 3)
**验收标准**:
- [ ] 所有 20+ 种类型的 Get/Set 函数实现
- [ ] 单元测试覆盖率 > 80%
- [ ] 无已知 Bug
- [ ] 性能测试：1000 次参数读写 < 100ms

### Milestone 2: 编辑器 UI 可用 (Week 6)
**验收标准**:
- [ ] 编辑器面板可正常打开
- [ ] 可选择场景中的 Niagara 组件
- [ ] 可手动调整所有类型参数
- [ ] 实时预览正常工作
- [ ] 撤销/重做功能正常

### Milestone 3: AI 基础功能 (Week 9)
**验收标准**:
- [ ] AI 服务连接成功（测试 100 次请求成功率 > 95%）
- [ ] 能正确解析简单指令（如 "增加生成速率"）
- [ ] 参数调整准确率 > 80%
- [ ] 平均响应时间 < 3 秒
- [ ] 支持中英文输入

### Milestone 4: 完整功能 (Week 12)
**验收标准**:
- [ ] 支持复杂多参数调整
- [ ] 多轮对话功能正常
- [ ] 预设系统可用
- [ ] 文档完整
- [ ] 至少 5 个完整的效果调整示例
- [ ] 通过内部测试（10 人以上试用）

---

## ⚠️ 风险评估与应对

### 技术风险

| 风险 | 可能性 | 影响 | 应对措施 |
|------|--------|------|----------|
| AI API 不稳定/速率限制 | 高 | 高 | 1. 实现请求队列和重试机制<br>2. 准备备用 AI 服务<br>3. 添加本地缓存 |
| AI 理解不准确 | 中 | 高 | 1. 优化提示词工程<br>2. 添加用户确认机制<br>3. 建立参数知识库 |
| UE 5.5 API 变化 | 中 | 中 | 1. 密切关注 Epic 更新<br>2. 抽象化 Niagara API 调用<br>3. 保持向后兼容 |
| 性能问题（编辑器卡顿） | 中 | 中 | 1. 异步处理所有 AI 请求<br>2. 参数更新批处理<br>3. 性能测试和优化 |
| 参数范围错误导致崩溃 | 低 | 高 | 1. 严格的参数验证<br>2. 安全范围限制<br>3. 异常捕获 |

### 项目风险

| 风险 | 可能性 | 影响 | 应对措施 |
|------|--------|------|----------|
| 开发周期超期 | 中 | 中 | 1. 采用敏捷开发，优先核心功能<br>2. 每周进度审查<br>3. 准备功能削减方案 |
| AI 成本超预算 | 中 | 低 | 1. 设置月度预算告警<br>2. 实现智能缓存减少请求<br>3. 考虑本地模型替代 |
| 用户需求不明确 | 低 | 中 | 1. 早期用户测试<br>2. 收集反馈迭代<br>3. 社区调研 |

---

## 💰 资源需求估算

### 人力资源

**最小团队配置**:
- 1 名 UE/C++ 开发者（全职）
- 1 名 AI/NLP 工程师（兼职/外包）
- 1 名 UI/UX 设计师（兼职）
- 1 名测试工程师（兼职）

**理想团队配置**:
- 2 名 UE/C++ 开发者
- 1 名 AI/NLP 工程师
- 1 名 UI/UX 设计师
- 1 名技术美术（提供测试资产和反馈）
- 1 名测试工程师

### 技术资源

**必需**:
- Unreal Engine 5.5 许可证（免费）
- AI API 服务（OpenAI/Claude）
  - 预估月费：$50-200（取决于使用量）
- 代码托管服务（GitHub/GitLab）
- 文档平台（Notion/Confluence）

**可选**:
- 持续集成服务（Jenkins/GitHub Actions）
- 性能分析工具（Unreal Insights）
- 错误追踪服务（Sentry）

### 预算估算

| 项目 | 月度费用 | 总计（3 个月） |
|------|----------|----------------|
| AI API 服务 | $100 | $300 |
| 开发工具订阅 | $50 | $150 |
| 测试资产 | $0 | $0 |
| 其他杂项 | $50 | $150 |
| **总计** | **$200** | **$600** |

---

## 📈 成功指标 (KPI)

### 技术指标
- [ ] 代码单元测试覆盖率 ≥ 80%
- [ ] AI 指令解析准确率 ≥ 80%
- [ ] 参数调整成功率 ≥ 95%
- [ ] 平均 AI 响应时间 ≤ 3 秒
- [ ] 编辑器 UI 响应时间 ≤ 100ms
- [ ] 崩溃率 < 0.1%

### 用户体验指标
- [ ] 用户上手时间 < 10 分钟
- [ ] 单次调整平均节省时间 > 50%（相比手动）
- [ ] 用户满意度 ≥ 4/5 星
- [ ] 复杂调整成功率 ≥ 60%

### 商业指标（如果发布到 Marketplace）
- [ ] 首月下载量 > 100
- [ ] 用户评分 ≥ 4.5/5 星
- [ ] 活跃用户留存率 > 40%（30 天）

---

## 🔄 迭代与持续改进

### 版本规划

**v0.1.0 - MVP (Week 6)**
- 基础参数读写
- 简单编辑器 UI
- 手动参数调整

**v0.5.0 - AI Alpha (Week 9)**
- AI 服务集成
- 基础自然语言理解
- 简单指令执行

**v1.0.0 - 正式版 (Week 12)**
- 完整 AI 功能
- 多轮对话
- 预设系统
- 完整文档

**v1.x.0 - 未来增强**
- 多语言支持
- 本地 AI 模型选项
- 高级效果模板
- 云端预设分享
- 协同编辑功能

### 反馈收集机制
- GitHub Issues/Discussions
- 用户调查问卷
- 内置反馈按钮
- 使用数据分析（匿名）

---

## 📚 参考资料

### UE 官方文档
- [Niagara Overview](https://docs.unrealengine.com/5.5/en-US/overview-of-niagara-effects-for-unreal-engine/)
- [Niagara C++ Reference](https://docs.unrealengine.com/5.5/en-US/API/Plugins/Niagara/)
- [Slate UI Framework](https://docs.unrealengine.com/5.5/en-US/slate-ui-framework/)

### AI 服务文档
- [OpenAI API Documentation](https://platform.openai.com/docs)
- [Anthropic Claude API](https://docs.anthropic.com/)
- [Llama.cpp GitHub](https://github.com/ggerganov/llama.cpp)

### 相关技术
- UE HTTP Module
- UE JSON Utilities
- 自然语言处理最佳实践
- 提示词工程指南

---

## 📝 附录

### A. 参数类型完整列表

当前支持的 Niagara 参数类型：
1. Bool
2. Int (int32)
3. Float
4. Double (GenericNumeric)
5. FFloat16 (Half)
6. FVector2D (Vec2)
7. FVector2DHalf (HalfVec2)
8. FVector (Vec3)
9. FVector4 (Vec4)
10. FQuat (Quaternion)
11. FMatrix (Matrix4)
12. FLinearColor (Color)
13. FNiagaraID (ID)
14. FNiagaraParameterMap
15. AActor*
16. UObject*
17. UMaterialInterface*
18. UTexture*
19. UTextureRenderTarget*

### B. 常见 Niagara 参数命名约定

```
User.{ParameterName}      # 用户参数（最常用）
Engine.{ParameterName}    # 引擎参数
System.{ParameterName}    # 系统级参数
Emitter.{ParameterName}   # 发射器参数
Particles.{ParameterName} # 粒子参数
```

### C. AI 提示词最佳实践

1. **明确角色**: 告诉 AI 它是什么（Niagara 专家）
2. **提供上下文**: 当前系统的完整参数列表
3. **结构化输出**: 要求 JSON 格式，易于解析
4. **范围限制**: 明确参数的有效范围
5. **Few-shot 示例**: 提供 2-3 个调整示例
6. **错误处理**: 要求 AI 在不确定时说明

### D. 测试用例示例

```cpp
// 示例测试：AI 理解"让火焰更大"
TEST_F(FAINiagaraTest, UnderstandSizeIncrease)
{
    FString UserInput = TEXT("让火焰更大");
    FString AIResponse = AIService->SendPrompt(BuildPrompt(Component, UserInput));
    
    FParameterAdjustments Adjustments = ParseAIResponse(AIResponse);
    
    EXPECT_TRUE(Adjustments.Contains(TEXT("User.Size")));
    EXPECT_GT(Adjustments[TEXT("User.Size")].AsVector().X, 1.0f);
}
```

---

## 📞 联系与支持

**项目负责人**: [待填写]  
**技术负责人**: [待填写]  
**项目仓库**: [GitHub URL]  
**文档地址**: [Documentation URL]  

---

**文档版本**: v1.0  
**最后更新**: 2025-01-XX  
**下次审查**: 每两周更新进度
